# üí≥ Fraud Detection Machine Learning Pipeline

This repository implements a full **end-to-end fraud detection system** using supervised machine learning techniques ‚Äî from raw data ingestion and preprocessing to model training, evaluation, and prediction.

The pipeline is designed with **industry best practices** including:
‚úÖ modular code  
‚úÖ logging  
‚úÖ exception handling  
‚úÖ imbalance handling with SMOTE  
‚úÖ metric-based model comparison and selection  

---

## üìÅ Project Folder Structure

```
fraud_detection/
‚îÇ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ raw/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ data_table.csv #downloaded data_table.csv should be stored here
‚îÇ   ‚îî‚îÄ‚îÄ processed/
‚îÇ       ‚îî‚îÄ‚îÄ processed_data.csv #this will be automatically generated in feature_engineering file
‚îÇ
‚îú‚îÄ‚îÄ models/ # this sholuld be empyt folder the pkl files will be automatically generated by train_model.py
‚îÇ   ‚îú‚îÄ‚îÄ logistic_model.pkl
‚îÇ   ‚îú‚îÄ‚îÄ tree_model.pkl
‚îÇ   ‚îú‚îÄ‚îÄ xgb_model.pkl
‚îÇ   ‚îî‚îÄ‚îÄ scaler.pkl
‚îÇ
‚îú‚îÄ‚îÄ reports/
‚îÇ   ‚îî‚îÄ‚îÄ model_comparison.csv
‚îÇ
‚îú‚îÄ‚îÄ logs/
‚îÇ   ‚îî‚îÄ‚îÄ fraud_detection_YYYY-MM-DD.log
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ data_preprocessing.py
‚îÇ   ‚îú‚îÄ‚îÄ feature_engineering.py
‚îÇ   ‚îú‚îÄ‚îÄ train_model.py
‚îÇ   ‚îú‚îÄ‚îÄ evaluate_models.py
‚îÇ   ‚îú‚îÄ‚îÄ predict.py
‚îÇ   ‚îú‚îÄ‚îÄ logger.py
‚îÇ   ‚îú‚îÄ‚îÄ exceptions.py
‚îÇ   ‚îî‚îÄ‚îÄ main.py
‚îÇ
‚îú‚îÄ‚îÄ notebooks/
‚îÇ   ‚îî‚îÄ‚îÄ eda.ipynb
‚îÇ
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```

---

## üß† Dataset

Due to file size limitations on GitHub, the full dataset is **hosted on Kaggle**:

üîó https://www.kaggle.com/datasets/tatapudibhaskar/paysim-synthetic-financial-transactions-dataset

This dataset contains synthetic transaction records with a binary `isFraud` label indicating fraudulent behavior.

---

## üêç Virtual Environment Setup

### ‚úÖ Using Python (Recommended)

Make sure you are using **Python 3.10.\***.

```bash
python3 -m venv projectenv
```

You may replace `projectenv` with any name.

---

### ‚úÖ Using Conda

```bash
conda create -n projectenv python=3.10 -y
conda activate projectenv
```

---

## ‚öôÔ∏è Activate Virtual Environment

### ‚ñ∂ Windows (PowerShell / CMD)

```bash
projectenv\Scripts\activate
```

### ‚ñ∂ macOS / Linux

```bash
source projectenv/bin/activate
```

---

## üì¶ Install Dependencies

```bash
pip install -r requirements.txt
```

---

## ‚ñ∂Ô∏è Run the ML Pipeline

From project root:

```bash
python -m src.main
```

This executes the full pipeline:
1. Load and clean data
2. Feature engineering
3. Train models
4. Evaluate models
5. Save artifacts
6. Produce logs and reports

---

## üìà What You Get as Output

‚úÖ **Processed Data**
```
data/processed/processed_data.csv
```

‚úÖ **Saved Models**
```
models/logistic_model.pkl
models/tree_model.pkl
models/xgb_model.pkl
models/scaler.pkl
```

‚úÖ **Evaluation Report**
```
reports/model_comparison.csv
```

‚úÖ **Logs**
```
logs/fraud_detection_YYYY-MM-DD.log
```

---

## üìä Model Evaluation Metrics

The models are evaluated using:

| Metric | Meaning |
|--------|---------|
| Recall | Fraud capture rate (primary metric) |
| Precision | Correct fraud output ratio |
| F1-Score | Harmonic mean of precision + recall |
| ROC-AUC | Tradeoff between TPR and FPR |
| PR-AUC | Best for imbalanced datasets |

Sample results:

```
Model                   Recall   Precision   F1_Score   ROC_AUC   PR_AUC
XGBoost                 0.93        0.21       0.34      0.97      0.91
Decision Tree           0.89        0.17       0.29      0.92      0.85
Logistic Regression     0.86        0.13       0.23      0.88      0.78
```

> **Recall is prioritized** because missing fraudulent transactions is costly in real systems.

---

## üîÆ Prediction (After Training)

Use the production predictor:

```python
from src.predict import FraudPredictor

predictor = FraudPredictor()

sample_transaction = [
    50000,  # amount
    1,      # type_CASH_OUT
    0,      # type_TRANSFER
    100000, # oldbalanceOrg
    50000,  # newbalanceOrig
    0,      # oldbalanceDest
    0,      # newbalanceDest
    1,      # merchant
    10,     # hour
    2       # day
]

result = predictor.predict(sample_transaction, threshold=0.3)
print(result)
```

---

## üìù Logging & Exception Handling

This project uses centralized logging (`src/logger.py`) and custom exceptions (`src/exceptions.py`) so that every error and process step is captured in logs for debugging and monitoring.

---

## üë§ Author

**Bhaskar (Phaneendra)**  
Machine Learning | Data Science Enthusiast# transaction_fraud_detection
# payment_fraud_detection
